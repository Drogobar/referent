# Инструкция по деплою и проверке

## Настройка переменных окружения на Vercel

### Шаг 1: Добавление API ключа

1. Перейдите в настройки проекта на [Vercel Dashboard](https://vercel.com/dashboard)
2. Выберите ваш проект
3. Перейдите в раздел **Settings** → **Environment Variables**
4. Нажмите **Add New**
5. Добавьте переменную:
   - **Name**: `OPENROUTER_API_KEY`
   - **Value**: ваш API ключ от OpenRouter
   - **Environment**: выберите все окружения (Production, Preview, Development)
6. Нажмите **Save**

### Шаг 2: Перезапуск деплоймента

После добавления переменной окружения:
1. Перейдите в раздел **Deployments**
2. Найдите последний деплоймент
3. Нажмите на три точки (⋯) и выберите **Redeploy**
4. Или сделайте новый commit и push в репозиторий

## Проверка работы функций на production

### Чек-лист тестирования

#### ✅ Парсинг статей
- [ ] Введите URL англоязычной статьи
- [ ] Нажмите "Парсить статью"
- [ ] Проверьте, что получен JSON с полями: `date`, `title`, `content`
- [ ] Убедитесь, что данные корректно извлечены

#### ✅ Перевод статьи
- [ ] Распарсите статью (предыдущий шаг)
- [ ] Нажмите "Перевести статью"
- [ ] Проверьте, что получен перевод на русский язык
- [ ] Убедитесь, что перевод читаемый и корректный

#### ✅ Генерация описания
- [ ] Распарсите статью
- [ ] Нажмите "О чем статья"
- [ ] Проверьте, что получено краткое описание (2-3 предложения)
- [ ] Убедитесь, что описание отражает основную тему статьи

#### ✅ Генерация тезисов
- [ ] Распарсите статью
- [ ] Нажмите "Тезисы"
- [ ] Проверьте, что получен список тезисов в формате маркированного списка
- [ ] Убедитесь, что тезисы информативны и структурированы

#### ✅ Генерация поста для Telegram
- [ ] Распарсите статью
- [ ] Нажмите "Пост для Telegram"
- [ ] Проверьте, что получен готовый пост
- [ ] Убедитесь, что пост содержит:
  - [ ] Привлекательный заголовок/начало
  - [ ] Основную информацию
  - [ ] Призыв к действию
  - [ ] Ссылку на источник в конце

### Тестирование с длинными статьями

- [ ] Найдите длинную статью (>20000 символов)
- [ ] Распарсите её
- [ ] Проверьте, что все функции работают корректно
- [ ] Убедитесь, что появляется предупреждение об обрезке контента (если применимо)

### Тестирование обработки ошибок

#### Отсутствие API ключа
- [ ] Временно удалите переменную окружения `OPENROUTER_API_KEY` на Vercel
- [ ] Попробуйте использовать AI-функции
- [ ] Проверьте, что отображается понятное сообщение об ошибке

#### Невалидный URL
- [ ] Введите невалидный URL
- [ ] Попробуйте распарсить
- [ ] Проверьте, что отображается сообщение об ошибке

#### Сеть недоступна
- [ ] Проверьте работу при временных проблемах с сетью
- [ ] Убедитесь, что ошибки обрабатываются корректно

## Мониторинг и логи

### Просмотр логов на Vercel

1. Перейдите в раздел **Deployments**
2. Выберите нужный деплоймент
3. Откройте вкладку **Functions**
4. Выберите нужную функцию (например, `/api/summary`)
5. Просмотрите логи выполнения

### Проверка ошибок

Если функции не работают:
1. Проверьте логи на Vercel
2. Убедитесь, что переменная `OPENROUTER_API_KEY` настроена
3. Проверьте, что API ключ валидный и активный
4. Убедитесь, что модель `deepseek/deepseek-r1-0528:free` доступна на OpenRouter

## Рекомендации

- Регулярно проверяйте баланс на OpenRouter (если используете платные модели)
- Мониторьте использование токенов через OpenRouter Dashboard
- Настройте алерты на Vercel для критических ошибок
- Документируйте любые проблемы и их решения

