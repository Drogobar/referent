# Referent

Приложение для анализа англоязычных статей с помощью AI. Написано на Next.js с использованием Tailwind CSS.

## Возможности

- **Парсинг HTML статей** — автоматическое извлечение заголовка, даты публикации и основного контента из англоязычных статей
- **Перевод статей** — перевод распарсенного контента с английского на русский язык с помощью AI
- **Краткое описание** — генерация краткого описания статьи (2-3 предложения) с объяснением основной темы и ключевых моментов
- **Тезисы** — создание структурированного списка основных тезисов статьи в формате маркированного списка
- **Пост для Telegram** — генерация привлекательного поста для Telegram канала на основе статьи с призывом к действию и ссылкой на источник

## Технологии

- **Next.js 14** (App Router)
- **React 18**
- **TypeScript**
- **Tailwind CSS 4**
- **Cheerio** (парсинг HTML)
- **OpenRouter AI** — для AI-обработки статей (перевод, генерация описаний, тезисов и постов)
- **DeepSeek R1** — языковая модель для AI-функций

## Разработка

### Установка зависимостей

```powershell
pnpm install
```

### Запуск dev-сервера

```powershell
pnpm dev
```

Приложение будет доступно по адресу [http://localhost:3000](http://localhost:3000)

### Сборка для production

```powershell
pnpm build
```

### Запуск production-версии

```powershell
pnpm start
```

### Линтинг

```powershell
pnpm lint
```

## Настройка переменных окружения

Для работы AI-функций (перевод, описание, тезисы, пост для Telegram) требуется API ключ от OpenRouter.

### Получение API ключа

1. Зарегистрируйтесь на [OpenRouter.ai](https://openrouter.ai/)
2. Перейдите в раздел "Keys" в личном кабинете
3. Создайте новый API ключ
4. Скопируйте ключ

### Настройка локально

Создайте файл `.env.local` в корне проекта:

```env
OPENROUTER_API_KEY=ваш_api_ключ_от_openrouter
```

### Настройка на Vercel

1. Перейдите в настройки проекта на Vercel
2. Откройте раздел "Environment Variables"
3. Добавьте переменную:
   - **Name**: `OPENROUTER_API_KEY`
   - **Value**: ваш API ключ от OpenRouter
4. Сохраните изменения
5. Перезапустите деплоймент

## Использование

### Базовый workflow

1. **Введите URL статьи** — вставьте ссылку на англоязычную статью
2. **Распарсите статью** — нажмите кнопку "Парсить статью" для извлечения контента
3. **Выберите действие**:
   - **Перевести статью** — получить перевод на русский язык
   - **О чем статья** — получить краткое описание
   - **Тезисы** — получить список основных тезисов
   - **Пост для Telegram** — сгенерировать пост для Telegram канала

### Примеры использования

#### Парсинг статьи
После ввода URL и нажатия "Парсить статью", вы получите JSON с данными:
```json
{
  "date": "2024-01-15",
  "title": "Article Title",
  "content": "Article content..."
}
```

#### Перевод статьи
После парсинга нажмите "Перевести статью" для получения перевода на русский язык.

#### Генерация описания
Нажмите "О чем статья" для получения краткого описания (2-3 предложения).

#### Создание тезисов
Нажмите "Тезисы" для получения структурированного списка основных тезисов.

#### Генерация поста для Telegram
Нажмите "Пост для Telegram" для создания готового поста с призывом к действию и ссылкой на источник.

## Деплой на Vercel

Проект готов к деплою на Vercel. Все необходимые настройки уже настроены.

### Автоматический деплой

1. Подключите репозиторий к Vercel через веб-интерфейс
2. Vercel автоматически определит настройки из `vercel.json`
3. Убедитесь, что `pnpm-lock.yaml` закоммичен в репозиторий
4. Деплой запустится автоматически при каждом push в основную ветку

### Ручной деплой через CLI

```powershell
# Установка Vercel CLI (если еще не установлен)
pnpm add -g vercel

# Деплой
vercel
```

### Настройки в vercel.json

- **installCommand**: `pnpm install --frozen-lockfile`
- **buildCommand**: `pnpm run build`
- **devCommand**: `pnpm dev`

### Важные замечания

- ✅ `pnpm-lock.yaml` должен быть закоммичен в репозиторий
- ✅ Vercel автоматически использует pnpm через Corepack
- ✅ **Обязательно** настройте переменную окружения `OPENROUTER_API_KEY` для работы AI-функций
- ✅ Парсинг статей работает без API ключа
- ✅ Next.js автоматически определяет output директорию (`.next`)

### Подробная инструкция по деплою

См. [DEPLOYMENT.md](./DEPLOYMENT.md) для детальных инструкций по настройке переменных окружения и проверке работы на production.

### Ограничения

- **Длина статей**: Статьи длиннее 18000-20000 символов автоматически обрезаются из-за ограничений модели (8192 токена)
- **Модель**: Используется бесплатная модель `deepseek/deepseek-r1-0528:free` через OpenRouter
- **Токены**: Модель имеет лимит 8192 токена на запрос

## Структура проекта

```
referent/
├── app/
│   ├── api/
│   │   ├── parse/
│   │   │   └── route.ts      # API для парсинга статей
│   │   ├── translate/
│   │   │   └── route.ts      # API для перевода статей
│   │   ├── summary/
│   │   │   └── route.ts      # API для генерации описания
│   │   ├── theses/
│   │   │   └── route.ts      # API для генерации тезисов
│   │   └── telegram/
│   │       └── route.ts      # API для генерации поста для Telegram
│   ├── globals.css           # Глобальные стили
│   ├── layout.tsx            # Корневой layout
│   └── page.tsx              # Главная страница
├── next.config.mjs           # Конфигурация Next.js
├── tailwind.config.ts        # Конфигурация Tailwind
├── postcss.config.mjs        # Конфигурация PostCSS
├── tsconfig.json             # Конфигурация TypeScript
├── vercel.json               # Конфигурация Vercel
└── package.json              # Зависимости проекта
```

## API Endpoints

### POST `/api/parse`
Парсинг HTML статьи и извлечение данных.

**Request:**
```json
{
  "url": "https://example.com/article"
}
```

**Response:**
```json
{
  "date": "2024-01-15",
  "title": "Article Title",
  "content": "Article content..."
}
```

### POST `/api/translate`
Перевод статьи с английского на русский.

**Request:**
```json
{
  "content": "Article content to translate"
}
```

**Response:**
```json
{
  "translation": "Переведенный текст статьи"
}
```

### POST `/api/summary`
Генерация краткого описания статьи.

**Request:**
```json
{
  "content": "Article content",
  "title": "Article title (optional)"
}
```

**Response:**
```json
{
  "summary": "Краткое описание статьи..."
}
```

### POST `/api/theses`
Генерация тезисов статьи.

**Request:**
```json
{
  "content": "Article content",
  "title": "Article title (optional)"
}
```

**Response:**
```json
{
  "theses": "• Тезис 1\n• Тезис 2\n..."
}
```

### POST `/api/telegram`
Генерация поста для Telegram.

**Request:**
```json
{
  "content": "Article content",
  "title": "Article title (optional)",
  "url": "Article URL (optional)"
}
```

**Response:**
```json
{
  "post": "Готовый пост для Telegram..."
}
```

## Автор

Тестовая программа-референт написана Максимом Жуковым с помощью Курсора
